---
title: "Pooling C-index of Logistic and Cox Regression Models"
author: "Martijn W Heymans"
date: "`r Sys.Date()`"
output:
  rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Pooling C-index of Logistic and Cox Regression Models}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(miceafter)
library(mice)
library(magrittr)
library(dplyr)
```

## Introduction

The `miceafter` package includes the function `pool_cindex`, to pool c-index values from logistic and Cox regression models. This vignette shows you how to use this function. 

## Examples

## In combination with the `mice` function 

The lbp_orig is a dataset with missing values. So we first impute them with the `mice` function. Than we use the `with.miceafter`  function to apply repeated analyses with the `cindex` function across the multiply imputed datasets. Finally, we pool the results by using the `pool_cindex` function.

```{r}

  imp_data <- mice(miceafter::lbp_orig, m=5, seed=3025, printFlag = FALSE) 

  object <- with.miceafter(data=imp_data,
   expr = cindex(glm(Chronic ~ Gender + Radiation, family="binomial")))

  res <- pool_cindex(object)
  res

```  

## In combination with stored Multiply Imputed datasets 

The dataset `lbpmilr` is a long dataset that contains 10 multiply imputed datasets. The datasets are distinguished by the `Impnr`  variable. First we convert the dataset into a `mids` object by the `makemids` function. Than we use the `with.miceafter`  function to apply repeated analyses with the `cindex` function across the multiply imputed datasets. Finally, we pool the results by using the `pool_cindex` function.

```{r}

  imp_data <- make_mids(lbpmilr, impvar = "Impnr") # MI datasets are in lbpmilr

  object <- with.miceafter(data=imp_data,
   expr = cindex(glm(Chronic ~ Gender + Radiation, family="binomial")))

  res <- pool_cindex(object)
  res

```  

